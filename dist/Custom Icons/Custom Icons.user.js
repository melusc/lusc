(()=>{"use strict";var e={22:e=>{e.exports='html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}a{background-color:transparent}img{border-style:none}button,input,select{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button{-webkit-appearance:button}button::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring{outline:1px dotted ButtonText}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}[hidden]{display:none}*,::after,::before{box-sizing:border-box}::after,::before{text-decoration:inherit;vertical-align:inherit}html{cursor:default;line-height:1.5;-moz-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-break:break-word}body,button,input,select{margin:0}a{background-color:transparent}img,svg{vertical-align:middle}img{border-style:none}svg:not(:root){overflow:hidden}button{-webkit-appearance:button}button,input{overflow:visible}button,select{text-transform:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}[tabindex],a,button,input,select{-ms-touch-action:manipulation;touch-action:manipulation}[hidden]{display:none}[disabled]{cursor:not-allowed}html{font-family:"Segoe UI",sans-serif;background:#15202b;color:#fff;font-size:.9375rem;font-weight:400;line-height:1.5;user-select:none}body{padding:1%}@media(min-width: 0px){:root{--sidebar-flex: 0 0 100%;--main-flex: 0 0 100%;--padding-horizontal: 0;--padding-vertical: 0.5%}}@media(min-width: 768px){:root{--sidebar-flex: 0 0 32%;--main-flex: 0 0 68%;--padding-horizontal: 0.5%;--padding-vertical: 0}}@media(min-width: 992px){:root{--sidebar-flex: 0 0 25%;--main-flex: 0 0 75%}}@media(min-width: 1200px){:root{--sidebar-flex: 0 0 20%;--main-flex: 0 0 80%}}.outer-sidebar{flex:var(--sidebar-flex);padding-right:var(--padding-horizontal);padding-bottom:var(--padding-vertical)}.outer-sidebar .sidebar{display:flex;flex-direction:column;padding:10px 15px;border:1.5px solid #fff;border-radius:4px}.outer-sidebar .row{cursor:pointer}.outer-sidebar .row:hover{text-decoration:underline;color:#999}.outer-sidebar .row[data-removed=false]{color:#2ecc40}.outer-sidebar .row[data-removed=true]{color:#ff4136}h3,h2{font-weight:300}h2{font-size:1.875rem}h3{font-size:1.64rem}input,button,select{background:none;box-shadow:none;border:1.5px solid #fff;color:inherit;border-radius:2px;padding:5px 15px;width:220px;max-width:100%;min-width:max-content;outline:none}input:disabled,button:disabled,select:disabled{color:#999;border-color:#999}button,select{width:auto}button:enabled,select:enabled{cursor:pointer}input[type=file]{border:none;padding:0;border-radius:0}.svg-icon-x{margin-left:5px;height:1em;width:1em;cursor:pointer}.svg-icon-x[data-svg-type=clear],.svg-icon-x[data-svg-type=del-icon]{color:#ff4136}.svg-icon-x[data-svg-type=del-icon]{margin-left:0;margin-right:5px}.svg-icon-x[data-svg-type=close]{color:#111;grid-column-start:3;grid-row-start:1;margin-left:auto}.btn-save{margin-top:10px;display:block}.icon{height:16px;width:16px;margin-right:5px}.icon:not(span){fill:#fff;stroke:#fff;-moz-context-properties:fill,stroke}span.icon{display:inline-block}.outer-main{flex:var(--main-flex);padding-left:var(--padding-horizontal);padding-top:var(--padding-vertical)}.main{padding:1.25rem 2.25rem;border:1.5px solid #fff;border-radius:4px}.container{display:flex;flex-direction:row;flex-wrap:wrap;width:100%;height:max-content}.outer-notification{position:absolute;top:0;left:0;width:100%;min-height:100%}.outer-notification,.notification-string{display:flex;justify-content:center;align-items:center}.inner-notification{display:grid;grid-template-columns:1fr auto 1fr;grid-template-rows:1fr auto 1fr;justify-items:center;width:375px;height:300px;max-height:90vh;max-width:90vw;background:#fff;border:#ddd solid 2px;border-radius:4px;padding:1em;margin-top:10vh}.notification-string{grid-area:2/2/3/3;text-align:center;color:#111}[data-blur=true]{filter:blur(4px)}'}},t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}(()=>{var e,t,o,r,i,l={},s=[],a=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function u(e,t){for(var n in t)e[n]=t[n];return e}function c(e){var t=e.parentNode;t&&t.removeChild(e)}function d(e,t,n){var o,r,i,l=arguments,s={};for(i in t)"key"==i?o=t[i]:"ref"==i?r=t[i]:s[i]=t[i];if(arguments.length>3)for(n=[n],i=3;i<arguments.length;i++)n.push(l[i]);if(null!=n&&(s.children=n),"function"==typeof e&&null!=e.defaultProps)for(i in e.defaultProps)void 0===s[i]&&(s[i]=e.defaultProps[i]);return p(e,s,o,r,null)}function p(t,n,o,r,i){var l={type:t,props:n,key:o,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++e.__v:i};return null!=e.vnode&&e.vnode(l),l}function _(e){return e.children}function f(e,t){this.props=e,this.context=t}function h(e,t){if(null==t)return e.__?h(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?h(e):null}function m(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return m(e)}}function g(n){(!n.__d&&(n.__d=!0)&&t.push(n)&&!v.__r++||r!==e.debounceRendering)&&((r=e.debounceRendering)||o)(v)}function v(){for(var e;v.__r=t.length;)e=t.sort((function(e,t){return e.__v.__b-t.__v.__b})),t=[],e.some((function(e){var t,n,o,r,i,l;e.__d&&(i=(r=(t=e).__v).__e,(l=t.__P)&&(n=[],(o=u({},r)).__v=r.__v+1,C(l,r,o,t.__n,void 0!==l.ownerSVGElement,null!=r.__h?[i]:null,n,null==i?h(r):i,r.__h),L(n,r),r.__e!=i&&m(r)))}))}function b(e,t,n,o,r,i,a,u,d,f){var m,g,v,b,x,k,S,M=o&&o.__k||s,L=M.length;for(d==l&&(d=null!=a?a[0]:L?h(o,0):null),n.__k=[],m=0;m<t.length;m++)if(null!=(b=n.__k[m]=null==(b=t[m])||"boolean"==typeof b?null:"string"==typeof b||"number"==typeof b?p(null,b,null,null,b):Array.isArray(b)?p(_,{children:b},null,null,null):b.__b>0?p(b.type,b.props,b.key,null,b.__v):b)){if(b.__=n,b.__b=n.__b+1,null===(v=M[m])||v&&b.key==v.key&&b.type===v.type)M[m]=void 0;else for(g=0;g<L;g++){if((v=M[g])&&b.key==v.key&&b.type===v.type){M[g]=void 0;break}v=null}C(e,b,v=v||l,r,i,a,u,d,f),x=b.__e,(g=b.ref)&&v.ref!=g&&(S||(S=[]),v.ref&&S.push(v.ref,null,b),S.push(g,b.__c||x,b)),null!=x?(null==k&&(k=x),"function"==typeof b.type&&null!=b.__k&&b.__k===v.__k?b.__d=d=y(b,d,e):d=w(e,b,v,M,a,x,d),f||"option"!==n.type?"function"==typeof n.type&&(n.__d=d):e.value=""):d&&v.__e==d&&d.parentNode!=e&&(d=h(v))}if(n.__e=k,null!=a&&"function"!=typeof n.type)for(m=a.length;m--;)null!=a[m]&&c(a[m]);for(m=L;m--;)null!=M[m]&&("function"==typeof n.type&&null!=M[m].__e&&M[m].__e==n.__d&&(n.__d=h(o,m+1)),R(M[m],M[m]));if(S)for(m=0;m<S.length;m++)P(S[m],S[++m],S[++m])}function y(e,t,n){var o,r;for(o=0;o<e.__k.length;o++)(r=e.__k[o])&&(r.__=e,t="function"==typeof r.type?y(r,t,n):w(n,r,r,e.__k,null,r.__e,t));return t}function w(e,t,n,o,r,i,l){var s,a,u;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(r==n||i!=l||null==i.parentNode)e:if(null==l||l.parentNode!==e)e.appendChild(i),s=null;else{for(a=l,u=0;(a=a.nextSibling)&&u<o.length;u+=2)if(a==i)break e;e.insertBefore(i,l),s=l}return void 0!==s?s:i.nextSibling}function x(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||a.test(t)?n:n+"px"}function k(e,t,n,o,r){var i,l,s;if(r&&"className"==t&&(t="class"),"style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof o&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||x(e.style,t,"");if(n)for(t in n)o&&n[t]===o[t]||x(e.style,t,n[t])}else"o"===t[0]&&"n"===t[1]?(i=t!==(t=t.replace(/Capture$/,"")),(l=t.toLowerCase())in e&&(t=l),t=t.slice(2),e.l||(e.l={}),e.l[t+i]=n,s=i?M:S,n?o||e.addEventListener(t,s,i):e.removeEventListener(t,s,i)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&"download"!==t&&"href"!==t&&"contentEditable"!==t&&!r&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,n))}function S(t){this.l[t.type+!1](e.event?e.event(t):t)}function M(t){this.l[t.type+!0](e.event?e.event(t):t)}function C(t,n,o,r,i,l,s,a,c){var d,p,h,m,g,v,y,w,x,k,S,M=n.type;if(void 0!==n.constructor)return null;null!=o.__h&&(c=o.__h,a=n.__e=o.__e,n.__h=null,l=[a]),(d=e.__b)&&d(n);try{e:if("function"==typeof M){if(w=n.props,x=(d=M.contextType)&&r[d.__c],k=d?x?x.props.value:d.__:r,o.__c?y=(p=n.__c=o.__c).__=p.__E:("prototype"in M&&M.prototype.render?n.__c=p=new M(w,k):(n.__c=p=new f(w,k),p.constructor=M,p.render=U),x&&x.sub(p),p.props=w,p.state||(p.state={}),p.context=k,p.__n=r,h=p.__d=!0,p.__h=[]),null==p.__s&&(p.__s=p.state),null!=M.getDerivedStateFromProps&&(p.__s==p.state&&(p.__s=u({},p.__s)),u(p.__s,M.getDerivedStateFromProps(w,p.__s))),m=p.props,g=p.state,h)null==M.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),null!=p.componentDidMount&&p.__h.push(p.componentDidMount);else{if(null==M.getDerivedStateFromProps&&w!==m&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(w,k),!p.__e&&null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(w,p.__s,k)||n.__v===o.__v){p.props=w,p.state=p.__s,n.__v!==o.__v&&(p.__d=!1),p.__v=n,n.__e=o.__e,n.__k=o.__k,p.__h.length&&s.push(p);break e}null!=p.componentWillUpdate&&p.componentWillUpdate(w,p.__s,k),null!=p.componentDidUpdate&&p.__h.push((function(){p.componentDidUpdate(m,g,v)}))}p.context=k,p.props=w,p.state=p.__s,(d=e.__r)&&d(n),p.__d=!1,p.__v=n,p.__P=t,d=p.render(p.props,p.state,p.context),p.state=p.__s,null!=p.getChildContext&&(r=u(u({},r),p.getChildContext())),h||null==p.getSnapshotBeforeUpdate||(v=p.getSnapshotBeforeUpdate(m,g)),S=null!=d&&d.type===_&&null==d.key?d.props.children:d,b(t,Array.isArray(S)?S:[S],n,o,r,i,l,s,a,c),p.base=n.__e,n.__h=null,p.__h.length&&s.push(p),y&&(p.__E=p.__=null),p.__e=!1}else null==l&&n.__v===o.__v?(n.__k=o.__k,n.__e=o.__e):n.__e=V(o.__e,n,o,r,i,l,s,c);(d=e.diffed)&&d(n)}catch(t){n.__v=null,(c||null!=l)&&(n.__e=a,n.__h=!!c,l[l.indexOf(a)]=null),e.__e(t,n,o)}}function L(t,n){e.__c&&e.__c(n,t),t.some((function(n){try{t=n.__h,n.__h=[],t.some((function(e){e.call(n)}))}catch(t){e.__e(t,n.__v)}}))}function V(e,t,n,o,r,i,a,u){var c,d,p,_,f,h=n.props,m=t.props;if(r="svg"===t.type||r,null!=i)for(c=0;c<i.length;c++)if(null!=(d=i[c])&&((null===t.type?3===d.nodeType:d.localName===t.type)||e==d)){e=d,i[c]=null;break}if(null==e){if(null===t.type)return document.createTextNode(m);e=r?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,m.is&&{is:m.is}),i=null,u=!1}if(null===t.type)h===m||u&&e.data===m||(e.data=m);else{if(null!=i&&(i=s.slice.call(e.childNodes)),p=(h=n.props||l).dangerouslySetInnerHTML,_=m.dangerouslySetInnerHTML,!u){if(null!=i)for(h={},f=0;f<e.attributes.length;f++)h[e.attributes[f].name]=e.attributes[f].value;(_||p)&&(_&&(p&&_.__html==p.__html||_.__html===e.innerHTML)||(e.innerHTML=_&&_.__html||""))}(function(e,t,n,o,r){var i;for(i in n)"children"===i||"key"===i||i in t||k(e,i,null,n[i],o);for(i in t)r&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||n[i]===t[i]||k(e,i,t[i],n[i],o)})(e,m,h,r,u),_?t.__k=[]:(c=t.props.children,b(e,Array.isArray(c)?c:[c],t,n,o,"foreignObject"!==t.type&&r,i,a,l,u)),u||("value"in m&&void 0!==(c=m.value)&&(c!==e.value||"progress"===t.type&&!c)&&k(e,"value",c,h.value,!1),"checked"in m&&void 0!==(c=m.checked)&&c!==e.checked&&k(e,"checked",c,h.checked,!1))}return e}function P(t,n,o){try{"function"==typeof t?t(n):t.current=n}catch(t){e.__e(t,o)}}function R(t,n,o){var r,i,l;if(e.unmount&&e.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||P(r,null,n)),o||"function"==typeof t.type||(o=null!=(i=t.__e)),t.__e=t.__d=void 0,null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(t){e.__e(t,n)}r.base=r.__P=null}if(r=t.__k)for(l=0;l<r.length;l++)r[l]&&R(r[l],n,o);null!=i&&c(i)}function U(e,t,n){return this.constructor(e,n)}function E(t,n,o){var r,a,u;e.__&&e.__(t,n),a=(r=o===i)?null:o&&o.__k||n.__k,t=d(_,null,[t]),u=[],C(n,(r?n:o||n).__k=t,a||l,l,void 0!==n.ownerSVGElement,o&&!r?[o]:a?null:n.childNodes.length?s.slice.call(n.childNodes):null,u,o||l,r),L(u,t)}e={__e:function(e,t){for(var n,o,r,i=t.__h;t=t.__;)if((n=t.__c)&&!n.__)try{if((o=n.constructor)&&null!=o.getDerivedStateFromError&&(n.setState(o.getDerivedStateFromError(e)),r=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),r=n.__d),r)return t.__h=i,n.__E=n}catch(t){e=t}throw e},__v:0},f.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=u({},this.state),"function"==typeof e&&(e=e(u({},n),this.props)),e&&u(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),g(this))},f.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),g(this))},f.prototype.render=_,t=[],o="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,v.__r=0,i=l;var G=function(e,t,n,o){var r;t[0]=0;for(var i=1;i<t.length;i++){var l=t[i++],s=t[i]?(t[0]|=l?1:2,n[t[i++]]):t[++i];3===l?o[0]=s:4===l?o[1]=Object.assign(o[1]||{},s):5===l?(o[1]=o[1]||{})[t[++i]]=s:6===l?o[1][t[++i]]+=s+"":l?(r=e.apply(s,G(e,s,n,["",null])),o.push(r),s[0]?t[0]|=2:(t[i-2]=0,t[i]=r)):o.push(s)}return o},T=new Map;var z=function(e){var t=T.get(this);return t||(t=new Map,T.set(this,t)),(t=G(this,t.get(e)||(t.set(e,t=function(e){for(var t,n,o=1,r="",i="",l=[0],s=function(e){1===o&&(e||(r=r.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?l.push(0,e,r):3===o&&(e||r)?(l.push(3,e,r),o=2):2===o&&"..."===r&&e?l.push(4,e,0):2===o&&r&&!e?l.push(5,0,!0,r):o>=5&&((r||!e&&5===o)&&(l.push(o,0,r,n),o=6),e&&(l.push(o,e,0,n),o=6)),r=""},a=0;a<e.length;a++){a&&(1===o&&s(),s(a));for(var u=0;u<e[a].length;u++)t=e[a][u],1===o?"<"===t?(s(),l=[l],o=3):r+=t:4===o?"--"===r&&">"===t?(o=1,r=""):r=t+r[0]:i?t===i?i="":r+=t:'"'===t||"'"===t?i=t:">"===t?(s(),o=1):o&&("="===t?(o=5,n=r,r=""):"/"===t&&(o<5||">"===e[a][u+1])?(s(),3===o&&(l=l[0]),o=l,(l=l[0]).push(2,0,o),o=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(s(),o=2):r+=t),3===o&&"!--"===r&&(o=4,l=l[0])}return s(),l}(e)),t),arguments,[])).length>1?t:t[0]}.bind(d),O=n(22);function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
// ==UserScript==
// @name         Custom Icons Preact
// @version      2021.01.17a
// @author       lusc
// @updateURL    https://github.com/melusc/moodle_userscripts/raw/master/dist/Custom%20Icons/Custom%20Icons.user.js
// @include      *://moodle.ksasz.ch/*
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        GM_addStyle
// @grant        GM_deleteValue
// @grant        GM_addValueChangeListener
// @grant        GM_registerMenuCommand
// @grant        GM_xmlhttpRequest
// @run-at       document-start
// ==/UserScript==
const j={error:Error("An error occured"),timeout:Error("Request timed out"),abort:Error("Request was aborted"),invalidSelector:Error("Invalid option selected"),statusCode:(e,t)=>new Error(`Error ${e}: ${t}`)},X=()=>{GM_registerMenuCommand("Open settings",(()=>{open("/customIconsPreact/","_blank")})),addEventListener("customIconsPreact",D),GM_getValue("pointers")||(GM_setValue("pointers",{}),GM_setValue("values",{})),D()},D=()=>{const e=oe(document);if(re(e)){const t=Object.keys(GM_getValue("pointers"));for(let n=0;n<t.length;n++)N(t[n],e);GM_addValueChangeListener("pointers",A)}},N=(e,t)=>{const n=t.querySelector(`a[href="https://moodle.ksasz.ch/course/view.php?id=${e}"]`);if(re(n)){if(n.childElementCount>0){const t=F(e);if("object"!=typeof t)return;if(t.isXML){const e=document.createElement("span");e.className="icon navicon",e.style.display="inline-block",e.style.color="var(--svg-fill, inherit)",E(z([t.rawXML]),e),n.firstElementChild.replaceWith(e)}else{const e=document.createElement("img");e.classList.add("icon","navicon"),e.setAttribute("aria-hidden",!0),e.style="fill: var(--svg-fill, inherit);stroke: var(--svg-fill, inherit);-moz-context-properties: fill, stroke;",e.tabIndex=-1,e.src=t.blobURL,e.addEventListener("load",(()=>{URL.revokeObjectURL(t)}),{once:!0}),n.firstElementChild.replaceWith(e)}}}else B(e)},F=e=>{const t=se(e);if("object"==typeof t){if(t.isXML)return t;const{mediaType:e,rawByteString:n}=t,o=atob(n),{length:r}=o,i=new ArrayBuffer(r),l=new Uint8Array(i);for(let e=0;e<r;e++)l[e]=o.charCodeAt(e);const s=new Blob([l],{type:e});return{blobURL:URL.createObjectURL(s),isXML:!1}}},A=(e,t,n,o)=>{if(!0===o){const e=oe(document),o=Object.entries(t),r=Object.entries(n).filter((([e,n])=>!1===t.hasOwnProperty(e)&&t[e]!==n)),i=o.filter((([e])=>!1===n.hasOwnProperty(e)));for(let t=0;t<i.length;t++){const[n]=i[t],o=e.querySelector(`a[href="https://moodle.ksasz.ch/course/view.php?id=${n}"] > .icon.navicon`);if(o&&("SPAN"===o.nodeName||"IMG"===o.nodeName)){const e=document.createElement("i");e.classList.add("icon","fa","fa-graduation-cap","fa-fw","navicon"),e.setAttribute("aria-hidden",!0),e.tabIndex=-1,o.replaceWith(e)}}for(let t=0;t<r.length;t++)N(r[t][0],e)}},B=e=>{q().then((t=>{t.hasOwnProperty(e)||(ae(e),alert(`You appear to not be in the course with the id "${e}" anymore.\nThe course will not be checked for anymore`))}))},$=()=>{history.replaceState({},"","/customIconsPreact/"),document.title="Custom Icons Preact Setup",GM_addStyle(O);const e=document.createElement("link");for(e.rel="shortcut icon",e.href='data:image/svg+xml,%3Csvg xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" viewBox%3D"0 74.46 344.72 235.31"%3E%3Cpath fill%3D"%23f98012" d%3D"M289.61 309.77V201.51q0-33.94-28-33.95t-28.06 33.95v108.26H178.4V201.51q0-33.94-27.57-33.95-28.05 0-28 33.95v108.26H67.67V195.12q0-35.43 24.6-53.63 21.66-16.25 58.56-16.25 37.41 0 55.12 19.19 15.26-19.19 55.62-19.19 36.9 0 58.54 16.25 24.6 18.19 24.61 53.63v114.65z"%2F%3E%3Cpath fill%3D"%23333" d%3D"M174.74 116.9l54.74-40-.7-2.44C130 86.57 85.08 95.15 0 144.47l.79 2.24 6.76.07c-.62 6.81-1.7 23.64-.32 48.95-9.44 27.32-.24 45.88 8.4 66.07 1.37-21 1.23-44-5.22-66.89-1.35-25.14-.24-41.67.37-48.1l56.4.54a258 258 0 001.67 33.06c50.4 17.71 101.09-.06 128-43.72-7.47-8.37-22.11-19.79-22.11-19.79z"%2F%3E%3C%2Fsvg%3E',document.head.append(e);document.body.lastChild;)document.body.lastChild.remove();E(d(H,null),document.body)};class H extends f{constructor(...e){super(...e),I(this,"render",((e,{courses:t,selectedCourse:n,inputStates:o,notificationString:r})=>d("div",{class:"container"},d(Z,{courses:t,handleClick:this.handleSidebarClick,blur:`${re(r)}`}),d(ne,{selectedCourse:n,courses:t,handleInput:this.handleMainInput,inputStates:o,handleSave:this.handleSave,inputRefs:this.inputRefs,blur:`${re(r)}`}),r&&d(ee,{handleClick:this.handleNotificationClick,notificationString:r})))),I(this,"state",{courses:[],notificationString:null,inputStates:{urlVal:"",fileVal:null,copyVal:null,current:null}}),I(this,"inputRefs",{}),I(this,"handleSidebarClick",(e=>{const{target:t}=e,n=t.closest(".row"),o=t.closest("svg"),r=o?.classList,{id:i}=n.dataset;if(re(o)&&r.contains("svg-icon-x")){ae(i);const e=[...this.state.courses];for(let t=0;t<e.length;t++)if(e[t].id===i){e[t]={...e[t],dataURI:null,rawXML:null,isXML:null};break}this.setState({selectedCourse:null,courses:e})}else if(re(n)){const e=this.state.courses.find((e=>e.id===i));this.setState({selectedCourse:{...e}}),scroll({top:0,left:0,behavior:"smooth"})}})),I(this,"saveHandlers",{url:e=>new Promise(((t,n)=>{const o=e.urlVal;GM_xmlhttpRequest({method:"GET",url:o,timeout:15e3,responseType:"blob",anonymous:!0,onabort:()=>n(j.abort),onerror:()=>{n(j.error)},ontimeout:()=>n(j.timeout),onload:e=>{200===e.status?this.saveHandlers.useFileReader(e.response).then(t).catch(n):n(j.statusCode(e.status,e.statusText))}})})),file:e=>new Promise(((t,n)=>{this.saveHandlers.useFileReader(e.fileVal).then(t).catch(n)})),copy:e=>new Promise(((t,n)=>{const o=e.copyVal,r=GM_getValue("pointers");if(r.hasOwnProperty(o)){const{id:e}=this.state.selectedCourse;ae(e),r[e]=r[o],GM_setValue("pointers",r),t()}else n(j.invalidSelector)})),useFileReader:e=>new Promise(((t,n)=>{const o=new FileReader;o.onload=()=>{const e=document.createElement("img");e.onerror=()=>n(j.error),e.onload=()=>{const{id:e}=this.state.selectedCourse,n=GM_getValue("pointers"),r=le();ae(e);const i=GM_getValue("values"),{mediaType:l,isBase64:s,rawByteString:a}=o.result.match(/^data:(?<mediaType>[\w+/]+);(?<isBase64>base64,)?(?<rawByteString>.+)$/).groups,u={mediaType:l};if("image/svg+xml"===l){const e=decodeURI(s?atob(a):a);u.rawXML=e}else u.rawByteString=s?a:btoa(decodeURI(a));i[r]=u,GM_setValue("values",i),n[e]=r,GM_setValue("pointers",n),t()},e.src=o.result},o.onerror=()=>n(j.error),o.readAsDataURL(e)}))}),I(this,"handleSave",(()=>{const{inputStates:e,selectedCourse:t}=this.state;if(re(t)){const t=e.current;re(t)?this.saveHandlers[t](e).then((()=>{const{id:e}=this.state.selectedCourse;this.setState((t=>{const n=[...t.courses];for(let t=0;t<n.length;t++)if(n[t].id===e){const o=se(e);if(n[t].isXML=o.isXML)n[t].rawXML=o.rawXML;else{const{mediaType:e,rawByteString:r}=o;n[t].dataURI=`data:${e};base64,${r}`}break}return{courses:n}}));const t=Object.values(this.inputRefs);for(let e=0;e<t.length;e++)t[e].value=null;this.setState({inputStates:{urlVal:"",fileVal:null,copyVal:null,current:null},selectedCourse:null})})).catch((e=>{this.setState({notificationString:e.message})})):this.setState({notificationString:"You haven't submitted an icon"})}else this.setState({notificationString:"You haven't selected a course"})})),I(this,"handleNotificationClick",(({target:e})=>{const t=e.closest("svg");(re(t)||e.classList.contains("outer-notification"))&&this.setState({notificationString:null})})),I(this,"inputHandlers",{file:(e,t)=>{const n=e.files[0];t.fileVal=n,t.current=re(n)?"file":null},url:(e,t)=>{const n=e.value.trim();t.urlVal=n,t.current=""===n?null:"url"},copy:(e,t)=>{const n=e.value;[t.copyVal,t.current]="null"===n?[null,null]:[n,"copy"]}}),I(this,"handleMainInput",(e=>{const{target:t}=e;this.setState((e=>{const n={...e.inputStates},o=t.dataset.inputType;return this.inputHandlers[o](t,n),{inputStates:n}}))}))}componentDidMount(){q().then((e=>{const t=Object.entries(e).map((([e,t])=>{const n=se(e);let o,r,i;if("object"==typeof n)if(({isXML:i}=n),i)({rawXML:r}=n);else{const{mediaType:e,rawByteString:t}=n;o=`data:${e};base64,${t}`}return{id:e,name:t.trim(),dataURI:o,isXML:i,rawXML:r}}));t.sort(((e,t)=>{const n=e.name.toLowerCase(),o=t.name.toLowerCase();return n<o?-1:n>o?1:0})),this.setState({courses:t})}))}}const q=(()=>{let e;return(t=!1)=>(!t&&e||(e=Promise.all([J(),W()]).then((([e,t])=>{const n=new URLSearchParams;return n.set("requests[0][function]","core_enrol_get_users_courses"),n.set("requests[0][arguments]",JSON.stringify({userid:t,returnusercount:!1})),n.set("wsfunction","tool_mobile_call_external_functions"),n.set("wstoken",e),fetch("/webservice/rest/server.php?moodlewsrestformat=json",{method:"POST",body:n.toString(),headers:{"content-type":"application/x-www-form-urlencoded"}}).then((e=>e.json()))})).then((e=>{if(e.hasOwnProperty("exception"))return Q(),q(!0);const t=JSON.parse(e.responses[0].data),n={};for(let e=0,o=t.length;e<o;++e){const{id:o,fullname:r}=t[e];n[o]=r}return Y(),n}))),e)})(),W=()=>J().then((e=>{const t=new URLSearchParams;return t.set("wsfunction","core_webservice_get_site_info"),t.set("wstoken",e),fetch("/webservice/rest/server.php?moodlewsrestformat=json",{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:t.toString()})})).then((e=>e.json())).then((e=>e.hasOwnProperty("exception")?(Q(),W()):(Y(),e.userid))),Y=()=>GM_setValue("lastValidatedToken",(new Date).getTime()),J=(()=>{let e;return(t=!1)=>{if(e)return e;const n=GM_getValue("token"),o=GM_getValue("lastValidatedToken");if(!e&&n&&(new Date).getTime()-o<18e6&&(e=Promise.resolve(n)),t||!e){const t=K("username","Username"),n=K("password","Password"),o=new URLSearchParams;o.set("username",t),o.set("password",n),o.set("service","moodle_mobile_app"),e=fetch("/login/token.php",{method:"POST",body:o.toString(),headers:{"content-type":"application/x-www-form-urlencoded"}}).then((e=>e.json())).then((e=>e.hasOwnProperty("errorcode")?(Q(!0),J(!0)):(GM_setValue("token",e.token),Y(),e.token)))}return e}})(),K=(e,t)=>{const n=GM_getValue(e);if(re(n))return n;const o=prompt(t);return GM_setValue(e,o),o},Q=(e=!1)=>{["token","lastValidatedToken"].map(GM_deleteValue),e&&["username","password"].map(GM_deleteValue)},Z=({blur:e,courses:t,handleClick:n})=>d("div",{"data-blur":e,class:"outer-sidebar",onClick:n},d("div",{class:"sidebar"},t?.map((({id:e,dataURI:t,name:n,isXML:o,rawXML:r})=>d("div",{class:"row","data-id":e,key:e},"boolean"==typeof o&&d(React.Fragment,null,o?d("span",{class:"icon"},z([r])):d("img",{class:"icon",src:t}),d(te,{type:"del-icon"})),d("span",null,n))))));class ee extends f{constructor(...e){super(...e),I(this,"render",(({handleClick:e,notificationString:t})=>d("div",{onClick:e,class:"outer-notification"},d("div",{class:"inner-notification"},d(te,{type:"close"}),d("div",{class:"notification-string"},t)))))}componentDidMount(){scroll({top:0,left:0,behavior:"smooth"})}}const te=e=>d("svg",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2","data-svg-type":e.type,class:"svg-icon svg-icon-x",viewBox:"0 0 24 24",onClick:e.handleClick},d("path",{d:"M24 0L0 24M0 0l24 24"}));class ne extends f{constructor(...e){super(...e),I(this,"render",(({selectedCourse:e,courses:t,inputStates:n,blur:o,handleInput:r,inputRefs:i,handleSave:l})=>{const s=se(e?.id);let a,u,c;if("object"==typeof s)if(({isXML:u}=s),u)({rawXML:c}=s);else{const{mediaType:e,rawByteString:t}=s;a=`data:${e};base64,${t}`}const p=e?.name,_=e?.id,{fileVal:f}=n;return d("div",{class:"outer-main","data-blur":o},d("div",{class:"main",onInput:r},d("h2",null,"Modify existing or add an icon"),d("div",null,a&&(u?z([c]):d("img",{src:a,class:"icon"})),d("span",null,p??"Select course on left")),d("h3",null,"Upload image from URL"),d("input",{type:"url",placeholder:"Image url",URL:!0,"data-input-type":"url",ref:e=>{i.url=e},disabled:null!==n.current&&"url"!==n.current}),d("h3",null,"Upload image from file"),d("input",{"data-input-type":"file",type:"file",hidden:!0,ref:e=>{i.file=e}}),d("button",{disabled:null!==n.current&&"file"!==n.current,onClick:()=>{i.file.click()}},re(f)?f.name:"Upload file",re(f)&&d(te,{type:"clear",handleClick:this.clearFile})),d("h3",null,"Copy image from other course"),d("select",{disabled:null!==n.current&&"copy"!==n.current,ref:e=>{i.copy=e},"data-input-type":"copy"},d("option",{value:"null",defaultValue:!0},"Select course to copy icon from"),t?.map((({id:e,name:t,dataURI:n,rawXML:o})=>(n||o)&&d("option",{key:_,value:e,disabled:e===_},t)))),d("button",{onClick:l,class:"btn-save"},"Save")))})),I(this,"clearFile",(e=>{const t=this.props.inputRefs.file;t.files.length>0&&(t.value=null,this.props.handleInput({target:t})),e.stopPropagation()}))}}const oe=e=>e.querySelector('li[aria-labelledby="label_2_4"] ul[role="group"]')??e.getElementById("label_3_21")?.closest('ul[role="group"]'),re=e=>null!=e,ie=e=>null==e,le=e=>e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,le),se=e=>{if(ie(e))return;const t=GM_getValue("pointers");if(ie(t))return GM_setValue("values",{}),void GM_setValue("pointers",{});const n=t[e];if(ie(n))return;const o=GM_getValue("values")[n];return o.hasOwnProperty("rawXML")?{rawXML:o.rawXML,isXML:!0}:{...o,isXML:!1}},ae=e=>{const t=GM_getValue("pointers"),n=GM_getValue("values"),o=t[e];if(re(o)){delete t[e];!1===Object.values(t).includes(o)&&(delete n[o],GM_setValue("values",n)),GM_setValue("pointers",t)}};if(!/^\/cleanmoodle/iu.test(location.pathname)){const e=/^\/customiconspreact/iu.test(location.pathname)?$:X;"complete"===document.readyState?e():addEventListener("DOMContentLoaded",e,{once:!0})}})()})();